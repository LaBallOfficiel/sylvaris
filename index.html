<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sylvaris - Saison 2</title>
    
    <link rel="stylesheet" href="main.css">
    <link rel="stylesheet" href="login.css">
    <link rel="stylesheet" href="layout.css">
    <link rel="stylesheet" href="forms.css">
    <link rel="stylesheet" href="kingdoms.css">
    <link rel="stylesheet" href="rules.css">
    <link rel="stylesheet" href="announcements.css">
</head>
<body>
    <div id="login-screen">
        <div class="login-container pixel-border">
            <h1 class="login-title">SYLVARIS - SAISON 2</h1>
            
            <!-- Pseudo -->
            <div class="input-group">
                <label>Pseudo Minecraft Bedrock</label>
                <input type="text" id="username" placeholder="Entre ton pseudo..." autocomplete="off">
            </div>
            
            <!-- Mot de passe existant -->
            <div class="input-group" id="password-group" style="display: none;">
                <label>Mot de passe</label>
                <input type="password" id="password" placeholder="Entre ton mot de passe..." autocomplete="off">
            </div>
            
            <!-- Lien "Mot de passe oubli√©" -->
            <div id="forgot-password-link" style="display: none; text-align: right; margin-top: -15px; margin-bottom: 15px;">
                <a href="#" onclick="showForgotPassword(); return false;" style="color: #a78bfa; font-size: 9px; text-decoration: underline;">Mot de passe oubli√© ?</a>
            </div>
            
            <!-- Nouveau mot de passe (premi√®re connexion) -->
            <div class="input-group" id="new-password-group" style="display: none;">
                <label>Cr√©e ton mot de passe</label>
                <input type="password" id="new-password" placeholder="Cr√©e un mot de passe..." autocomplete="off">
            </div>
            
            <div class="input-group" id="confirm-password-group" style="display: none;">
                <label>Confirme ton mot de passe</label>
                <input type="password" id="confirm-password" placeholder="Confirme ton mot de passe..." autocomplete="off">
            </div>
            
            <!-- Reset mot de passe -->
            <div class="input-group" id="reset-password-group" style="display: none;">
                <label>Nouveau mot de passe</label>
                <input type="password" id="reset-password" placeholder="Entre ton nouveau mot de passe..." autocomplete="off">
            </div>
            
            <div class="input-group" id="reset-confirm-password-group" style="display: none;">
                <label>Confirme le nouveau mot de passe</label>
                <input type="password" id="reset-confirm-password" placeholder="Confirme ton nouveau mot de passe..." autocomplete="off">
            </div>
            
            <!-- Boutons -->
            <button class="btn pixel-border" id="login-btn" onclick="login()">Se connecter</button>
            <button class="btn pixel-border" id="reset-password-btn" onclick="resetPassword()" style="display: none; background: #f59e0b; border-color: #fbbf24;">R√©initialiser le mot de passe</button>
            <button class="btn pixel-border" id="cancel-reset-btn" onclick="cancelReset()" style="display: none; background: #6b7280; border-color: #9ca3af; margin-top: 10px;">Annuler</button>
            
            <!-- Loader de connexion -->
            <div class="login-loader" id="login-loader">
                <div class="spinner"></div>
                <div class="loader-text">
                    <p>Connexion en cours...</p>
                    <p>Cela peut prendre 1 √† 2 minutes</p>
                </div>
            </div>
            
            <!-- Messages -->
            <div class="error-message" id="error-message">Acc√®s refus√©. Pseudo non autoris√©.</div>
            <div class="success-message" id="success-message-reset" style="display: none;">Mot de passe r√©initialis√© !</div>
        </div>
    </div>

    <div id="main-app">
        <!-- Reste de l'application... -->
        <div class="header">
            <img src="logoS.png" alt="Logo Sylvaris" class="logo" id="server-logo">
            <div class="user-info">Connect√© en tant que <span id="current-user"></span></div>
        </div>

        <div class="container">
            <div class="sidebar">
                <div class="menu-item active" data-section="accueil">Accueil</div>
                <div class="menu-item" data-section="annonces">üì¢ Annonces</div>
                <div class="menu-item" data-section="regle">R√®gle</div>
                <div class="menu-item" data-section="royaumes">Royaumes</div>
                <div class="menu-item" data-section="creer-royaume">Cr√©er un royaume</div>
            </div>

            <div class="content">
                <div class="content-section active" id="accueil">
                    <div class="welcome-box pixel-border">
                        <h2>üåç Serveur Minecraft Bedrock RP ‚Äì Realms</h2>
                        <p>Rejoins un serveur RolePlay unique o√π tu peux cr√©er ou rejoindre un royaume, b√¢tir ton territoire, √©crire ton lore et interagir avec les autres joueurs par la diplomatie, le commerce ou la guerre.</p>
                        <p>Chaque banni√®re repr√©sente un royaume, chaque d√©cision a des cons√©quences. Un monde vivant, libre, strat√©gique et enti√®rement fa√ßonn√© par les joueurs.</p>
                        <p><strong>üëâ Ton royaume. Ton histoire. Ton monde.</strong></p>
                    </div>
                </div>

                <div class="content-section" id="annonces">
                    <div class="welcome-box pixel-border">
                        <h2>üì¢ Annonces & Mises √† Jour</h2>
                        <p>Restez inform√©s des derni√®res nouvelles du serveur Sylvaris</p>
                    </div>

                    <div id="admin-announcement-form" style="display: none;">
                        <div class="form-box pixel-border">
                            <h3>üìù Publier une annonce (Admin)</h3>
                            <form id="announcement-form" onsubmit="createAnnouncement(event)">
                                <div class="form-field">
                                    <label>Titre de l'annonce</label>
                                    <input type="text" id="announcement-title" required placeholder="Ex: Mise √† jour 2.0">
                                </div>
                                <div class="form-field">
                                    <label>Contenu de l'annonce</label>
                                    <textarea id="announcement-content" required placeholder="√âcrivez votre annonce ici..." style="min-height: 150px;"></textarea>
                                </div>
                                <div class="form-field">
                                    <label>Image (optionnel)</label>
                                    <input type="file" id="announcement-image" accept="image/*">
                                    <small style="color: #a78bfa; font-size: 9px; display: block; margin-top: 5px;">üì∏ Ajoutez une image pour illustrer votre annonce</small>
                                </div>
                                <button type="submit" class="btn pixel-border">üì§ Publier l'annonce</button>
                                <div class="success-message" id="announcement-success">Annonce publi√©e avec succ√®s!</div>
                                <div class="error-message" id="announcement-error" style="display: none;">Erreur lors de la publication</div>
                            </form>
                        </div>
                    </div>

                    <div id="announcements-list">
                        <div class="loading-message pixel-border" style="text-align: center; padding: 30px; color: #a78bfa;">
                            Chargement des annonces...
                        </div>
                    </div>
                </div>

                <div class="content-section" id="regle">
                    <div class="welcome-box pixel-border">
                        <h2>üìú R√®glement Officiel du Serveur</h2>
                    </div>

                    <div class="rules-container">
                        <div class="rule-item pixel-border">
                            <div class="rule-header" onclick="toggleRule(1)">
                                <span>1. ü§ù R√®gles G√©n√©rales de Conduite</span>
                                <span class="arrow" id="arrow-1">‚ñº</span>
                            </div>
                            <div class="rule-content" id="rule-1">
                                <ul>
                                    <li>Le respect entre les joueurs est obligatoire. Aucun propos discriminatoire, insultant ou provocateur ne sera tol√©r√©.</li>
                                    <li>Le harc√®lement, les menaces ou comportements toxiques sont strictement interdits.</li>
                                    <li>L'usage de cheats, mods non autoris√©s, ou toute forme de triche est interdit.</li>
                                    <li>Respectez toujours les d√©cisions de l'administration et des mod√©rateurs.</li>
                                </ul>
                            </div>
                        </div>

                        <div class="rule-item pixel-border">
                            <div class="rule-header" onclick="toggleRule(2)">
                                <span>2. üëë Royaumes et Banni√®res</span>
                                <span class="arrow" id="arrow-2">‚ñº</span>
                            </div>
                            <div class="rule-content" id="rule-2">
                                <p><strong>Pour cr√©er un royaume, vous devez :</strong></p>
                                <ul>
                                    <li>Cr√©er un embl√®me unique sur une banni√®re.</li>
                                    <li>Enregistrer votre royaume et son embl√®me sur le serveur Discord.</li>
                                </ul>
                                <p><strong>R√®gles des banni√®res :</strong></p>
                                <ul>
                                    <li>Tout b√¢timent arborant l'embl√®me d'un royaume est consid√©r√© comme appartenant √† ce royaume.</li>
                                    <li>Un b√¢timent sans embl√®me peut √™tre conquis en y posant une banni√®re visible de votre royaume.</li>
                                    <li>‚ö†Ô∏è Un b√¢timent sans aucune banni√®re est consid√©r√© comme abandonn√© : il n'appartient √† personne et peut √™tre d√©truit, modifi√© ou r√©utilis√© librement.</li>
                                    <li>Un b√¢timent peut appartenir √† plusieurs royaumes si plusieurs banni√®res sont pr√©sentes (partage officiel).</li>
                                </ul>
                                <p><strong>Fronti√®res :</strong></p>
                                <ul>
                                    <li>Les royaumes peuvent d√©finir des fronti√®res par pose de blocs (max 4 cartes en jeu), qui doivent contenir la banni√®re du royaume.</li>
                                    <li>Seul le royaume propri√©taire de la fronti√®re peut construire √† l'int√©rieur, sauf accord.</li>
                                    <li>Les b√¢timents √† l'int√©rieur de la fronti√®re n'ont pas besoin d'arborer une banni√®re, sauf s'ils appartiennent √† un autre royaume.</li>
                                </ul>
                                <p><strong>Destruction de banni√®res :</strong></p>
                                <ul>
                                    <li>Les banni√®res ne peuvent √™tre d√©truites qu'en cas de guerre officielle, lors d'une vente, ou par d√©cision du chef du royaume.</li>
                                </ul>
                                <p><strong>Zones libres :</strong></p>
                                <ul>
                                    <li>Les zones hors royaumes et spawn sont libres : pvp, TNT, et construction/d√©construction sont soumis uniquement aux r√®gles g√©n√©rales du serveur.</li>
                                </ul>
                            </div>
                        </div>

                        <div class="rule-item pixel-border">
                            <div class="rule-header" onclick="toggleRule(3)">
                                <span>3. ‚öîÔ∏è Guerre et Diplomatie</span>
                                <span class="arrow" id="arrow-3">‚ñº</span>
                            </div>
                            <div class="rule-content" id="rule-3">
                                <ul>
                                    <li>Les guerres doivent √™tre d√©clar√©es officiellement sur Discord avant toute action hostile.</li>
                                    <li>Pendant une guerre, le PvP et la destruction de b√¢timents ennemis sont autoris√©s.</li>
                                    <li>Les trait√©s de paix, alliances et accords commerciaux doivent √™tre document√©s sur Discord.</li>
                                    <li>Le grief gratuit et non justifi√© par une guerre d√©clar√©e est interdit.</li>
                                </ul>
                            </div>
                        </div>

                        <div class="rule-item pixel-border">
                            <div class="rule-header" onclick="toggleRule(4)">
                                <span>4. üí∞ √âconomie et Commerce</span>
                                <span class="arrow" id="arrow-4">‚ñº</span>
                            </div>
                            <div class="rule-content" id="rule-4">
                                <ul>
                                    <li>Chaque royaume d√©finit sa propre monnaie.</li>
                                    <li>Les √©changes commerciaux entre royaumes sont encourag√©s.</li>
                                    <li>Les vols et arnaques sont interdits, sauf en temps de guerre d√©clar√©e.</li>
                                    <li>Les march√©s et zones commerciales neutres doivent √™tre respect√©s.</li>
                                </ul>
                            </div>
                        </div>

                        <div class="rule-item pixel-border">
                            <div class="rule-header" onclick="toggleRule(5)">
                                <span>5. üó∫Ô∏è Construction et Territoire</span>
                                <span class="arrow" id="arrow-5">‚ñº</span>
                            </div>
                            <div class="rule-content" id="rule-5">
                                <ul>
                                    <li>Construisez uniquement sur votre territoire ou avec permission.</li>
                                    <li>Les constructions doivent respecter le lore et l'esth√©tique du serveur.</li>
                                    <li>Ne construisez pas trop pr√®s du spawn ou des territoires existants sans accord.</li>
                                    <li>Les structures abandonn√©es sans banni√®re peuvent √™tre d√©molies ou r√©cup√©r√©es.</li>
                                </ul>
                            </div>
                        </div>

                        <div class="rule-item pixel-border">
                            <div class="rule-header" onclick="toggleRule(6)">
                                <span>6. üìã Sanctions</span>
                                <span class="arrow" id="arrow-6">‚ñº</span>
                            </div>
                            <div class="rule-content" id="rule-6">
                                <ul>
                                    <li>Avertissement : premi√®re infraction mineure.</li>
                                    <li>Bannissement temporaire : infractions r√©p√©t√©es ou graves.</li>
                                    <li>Bannissement d√©finitif : triche, harc√®lement grave, ou comportement toxique persistant.</li>
                                    <li>Toutes les sanctions sont d√©cid√©es par l'administration et peuvent √™tre contest√©es sur Discord.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="content-section" id="royaumes">
                    <div class="welcome-box pixel-border">
                        <h2>üè∞ Royaumes du Serveur</h2>
                    </div>
                    <div id="kingdoms-list"></div>
                </div>

                <div class="content-section" id="creer-royaume">
                    <div class="form-box pixel-border">
                        <h3>Cr√©er un nouveau royaume</h3>
                        <form id="kingdom-form" onsubmit="createKingdom(event)">
                            <div class="form-field">
                                <label>Nom du royaume</label>
                                <input type="text" id="kingdom-name" required>
                            </div>
                            <div class="form-field">
                                <label>Pseudo du roi</label>
                                <input type="text" id="king-name" required>
                            </div>
                            <div class="form-field">
                                <label>Logo du royaume (requis)</label>
                                <input type="file" id="kingdom-logo" accept="image/*" required>
                                <small style="color: #a78bfa; font-size: 9px; display: block; margin-top: 5px;">üì∏ Fichier image (PNG, JPG, GIF)</small>
                            </div>
                            <div class="form-field">
                                <label>Banni√®re du royaume (optionnel)</label>
                                <input type="file" id="kingdom-banner" accept="image/*">
                                <small style="color: #a78bfa; font-size: 9px; display: block; margin-top: 5px;">üì∏ Fichier image (PNG, JPG, GIF)</small>
                            </div>
                            <div class="form-field">
                                <label>Type de monnaie</label>
                                <select id="currency-type" required>
                                    <option value="">S√©lectionne une monnaie</option>
                                    <option value="emeraude">√âmeraude</option>
                                    <option value="diamant">Diamant</option>
                                    <option value="or">Or</option>
                                    <option value="netherite">Netherite</option>
                                    <option value="custom">Personnalis√©e</option>
                                </select>
                            </div>
                            <button type="submit" class="btn pixel-border">Cr√©er le royaume</button>
                            <div class="success-message" id="create-success">Royaume cr√©√© avec succ√®s!</div>
                            <div class="error-message" id="create-error" style="display: none;">Erreur lors de la cr√©ation</div>
                        </form>
                    </div>

                    <div id="kingdom-management" style="display: none;">
                        <div class="kingdom-info pixel-border">
                            <div class="kingdom-header">
                                <div class="kingdom-images">
                                    <img id="display-logo" class="kingdom-logo" src="" alt="Logo">
                                    <img id="display-banner" class="kingdom-banner" src="" alt="Banni√®re" style="display: none;">
                                </div>
                                <div class="kingdom-title">
                                    <h2 id="display-kingdom-name"></h2>
                                    <p>Roi: <span id="display-king-name"></span> | Monnaie: <span id="display-currency"></span></p>
                                </div>
                                <button class="btn-small pixel-border" onclick="toggleEditMode()">‚úèÔ∏è Modifier</button>
                            </div>

                            <div id="edit-mode" style="display: none;">
                                <div class="form-field">
                                    <label>Nom du royaume</label>
                                    <input type="text" id="edit-kingdom-name">
                                </div>
                                <div class="form-field">
                                    <label>Pseudo du roi</label>
                                    <input type="text" id="edit-king-name">
                                </div>
                                <div class="form-field">
                                    <label>Nouveau logo (optionnel)</label>
                                    <input type="file" id="edit-kingdom-logo" accept="image/*">
                                </div>
                                <div class="form-field">
                                    <label>Nouvelle banni√®re (optionnel)</label>
                                    <input type="file" id="edit-kingdom-banner" accept="image/*">
                                </div>
                                <div class="form-field">
                                    <label>Type de monnaie</label>
                                    <select id="edit-currency-type">
                                        <option value="emeraude">√âmeraude</option>
                                        <option value="diamant">Diamant</option>
                                        <option value="or">Or</option>
                                        <option value="netherite">Netherite</option>
                                        <option value="custom">Personnalis√©e</option>
                                    </select>
                                </div>
                                <button class="btn-small pixel-border" onclick="saveKingdomEdits()">üíæ Enregistrer</button>
                                <button class="btn-small pixel-border" onclick="toggleEditMode()" style="background: #dc2626; border-color: #ef4444;">‚ùå Annuler</button>
                            </div>

                            <div class="form-field" style="margin-top: 30px;">
                                <label>R√©sidents du royaume</label>
                                <ul class="residents-list" id="residents-list"></ul>
                                <div class="add-resident-form">
                                    <select id="new-resident">
                                        <option value="">S√©lectionne un joueur...</option>
                                    </select>
                                    <button class="btn-small pixel-border" onclick="addResident()">Ajouter</button>
                                </div>
                            </div>

                            <div class="form-field">
                                <label>Lois du royaume</label>
                                <textarea id="kingdom-laws" placeholder="√âcris les lois de ton royaume..."></textarea>
                                <button class="btn-small pixel-border" onclick="saveLaws()" style="margin-top: 10px;">Sauvegarder les lois</button>
                            </div>

                            <div class="danger-zone pixel-border" style="margin-top: 40px; padding: 20px; background: rgba(220, 38, 38, 0.1); border-color: #dc2626;">
                                <h3 style="color: #ef4444; font-size: 14px; margin-bottom: 15px;">‚ö†Ô∏è Zone dangereuse</h3>
                                <p style="font-size: 10px; color: #fca5a5; margin-bottom: 15px;">La suppression de votre royaume est d√©finitive et irr√©versible.</p>
                                <button class="btn-danger pixel-border" onclick="deleteKingdom()">üóëÔ∏è Supprimer le royaume</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <button class="logout-btn pixel-border" onclick="logout()">D√©connexion</button>
    </div>

    <script src="config.js"></script>
    <script src="utils.js"></script>
    <script src="auth.js"></script>
    <script src="kingdoms.js"></script>
    <script src="residents.js"></script>
    <script src="announcements.js"></script>
    <script src="ui.js"></script>
</body>
</html>